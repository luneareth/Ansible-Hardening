---
- name: Install AIDE on RPM Packages
  yum:
      name: aide
      state: present
  when: ansible_os_family == 'CentOS' or ansible_os_family == 'RedHat'
  tags: 
    - iam-file_integrity
    


- name: Install AIDE on DEB Packages
  apt:
      name: aide
      state: present
  when: ansible_os_family == 'Debian' or ansible_os_family == 'Ubuntu'
  tags: 
    - iam-file_integrity
   


- name: Iniziate Database Aide RPM Based
  shell: aide --init
  when: ansible_os_family == 'CentOS' or ansible_os_family == 'RedHat'
  tags: 
    - iam-file_integrity
   

- name: Iniziate Database Aide DEB Based
  shell: aideinit
  when: ansible_os_family == 'Debian' or ansible_os_family == 'Ubuntu'
  tags: 
    - iam-file_integrity
    

- name: Copy Database to Lib
  copy: 
      src: /var/lib/aide/aide.db.new.gz
      dest: /var/lib/aide/aide.db.gz
      remote_src: true
  tags: 
    - iam-file_integrity
   

- name: Init Configuration Debian
  shell: /usr/sbin/update-aide.conf
  when: ansible_os_family == 'Debian' or ansible_os_family == 'Ubuntu'
  tags:
     - iam-file_integrity
    

- name: Copy Configuration Init Debian
  copy:
    src: /var/lib/aide/aide.conf.autogenerated
    dest: /etc/aide/aide.conf
    remote_src: true
  when: ansible_os_family == 'Debian' or ansible_os_family == 'Ubuntu'
  tags:
    - iam-file_integrity

